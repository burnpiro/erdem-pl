{"componentChunkName":"component---src-templates-post-template-js","path":"/2019/09/react-state-management-without-libraries-with-hooks-part-2","webpackCompilationHash":"1bba8b144afea3add26d","result":{"data":{"markdownRemark":{"fields":{"slug":"/2019/09/react-state-management-without-libraries-with-hooks-part-2","tagSlugs":["/tag/javascript/","/tag/react/","/tag/state/"],"readTime":{"text":"15 min read","minutes":14.816666666666666}},"frontmatter":{"description":"How to manage state without any external libraries in React - Part 2? Simplifying your reducers and application logic.","tags":["Javascript","React","State"],"date":"2019-09-15","title":"React - state management without libraries (with hooks) PART 2"},"html":"<blockquote>\n<p>It might be beneficial to have CodeSandbox editor opened when reading this blog post.</p>\n</blockquote>\n<iframe src=\"https://codesandbox.io/embed/mutable-dust-yggp9?fontsize=14\" title=\"mutable-dust-yggp9\" allow=\"geolocation; microphone; camera; midi; vr; accelerometer; gyroscope; payment; ambient-light-sensor; encrypted-media; usb\" style=\"width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;\" sandbox=\"allow-modals allow-forms allow-popups allow-scripts allow-same-origin\"></iframe>\n<blockquote>\n<p>This is a second part of “State management without libraries”. If you didn’t read first one, it might be difficult to follow this one, so please check out <a href=\"https://erdem.pl/2019/09/react-state-management-without-libraries-with-hooks\">Part 1</a></p>\n</blockquote>\n<h2 id=\"what-is-wrong-with-part-1\"><a href=\"#what-is-wrong-with-part-1\" aria-label=\"what is wrong with part 1 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is wrong with Part 1?</h2>\n<p>As you remember in the first part we’ve created <code class=\"language-text\">AppStateContext</code> that allows us to store our app state within React’s <strong>Context</strong> and modify it using a reducer. The only problem with that one is <strong>63</strong>. That is a number of lines used to create our reducer. </p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token comment\">// AppState.tsx</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">:</span> AppState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> ActionType</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">type</span><span class=\"token punctuation\">,</span> payload <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> action<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">ACTIONS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">SET</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">[</span>payload<span class=\"token punctuation\">.</span>name <span class=\"token keyword\">as</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> payload<span class=\"token punctuation\">.</span>value\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">ACTIONS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADD_ITEM</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        list<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span>payload<span class=\"token punctuation\">,</span>\n            seen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            isInFavourites<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n            hashId<span class=\"token punctuation\">:</span> <span class=\"token function\">uuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>list\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">ACTIONS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADD_TO_FAVOURITES</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">const</span> el <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">el</span> <span class=\"token operator\">=></span> el<span class=\"token punctuation\">.</span>hashId <span class=\"token operator\">===</span> payload<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>el <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> el<span class=\"token punctuation\">.</span>isInFavourites<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        list<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>hashId <span class=\"token operator\">===</span> payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token operator\">...</span>element<span class=\"token punctuation\">,</span>\n              isInFavourites<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> element<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        favourites<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span>el<span class=\"token punctuation\">,</span>\n            isInFavourites<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>favourites\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">case</span> <span class=\"token constant\">ACTIONS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">REMOVE_FROM_FAVOURITES</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        list<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">.</span>hashId <span class=\"token operator\">===</span> payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n              <span class=\"token operator\">...</span>element<span class=\"token punctuation\">,</span>\n              isInFavourites<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span>\n          <span class=\"token keyword\">return</span> element<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n        favourites<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>favourites<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">fav</span> <span class=\"token operator\">=></span> fav<span class=\"token punctuation\">.</span>hashId <span class=\"token operator\">!==</span> payload<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>That’s fine, but after adding some more functionality to our app it grows linear. Because we don’t want to end up with 1k lines long file we have to make something to rearrange our structure.</p>\n<h2 id=\"splitting-the-main-reducer-into-chunks\"><a href=\"#splitting-the-main-reducer-into-chunks\" aria-label=\"splitting the main reducer into chunks permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Splitting the main reducer into chunks</h2>\n<p>Our main <code class=\"language-text\">reducer</code> contains all types of actions and the first thing we have to do is to group them by purpose (or sth else). </p>\n<p> First idea is to create 3 reducers:</p>\n<ul>\n<li><code class=\"language-text\">favouritesReducer</code> - handles all actions for <strong>favourites</strong> property</li>\n<li><code class=\"language-text\">listReducer</code> - handles all actions for <strong>list</strong> property</li>\n<li><code class=\"language-text\">settingsReducer</code> - handles all actions for <strong>setting</strong> property</li>\n</ul>\n<p> E.g. our <code class=\"language-text\">listReducer.ts</code> will look like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">listReducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">:</span> AppState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> ActionType</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">type</span><span class=\"token punctuation\">,</span> payload <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> action<span class=\"token punctuation\">;</span>\n <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">type</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n   <span class=\"token keyword\">case</span> <span class=\"token constant\">ACTIONS</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ADD_ITEM</span><span class=\"token punctuation\">:</span>\n     <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n       <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n       list<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n         <span class=\"token punctuation\">{</span>\n           <span class=\"token operator\">...</span>payload<span class=\"token punctuation\">,</span>\n           seen<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n           isInFavourites<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n           hashId<span class=\"token punctuation\">:</span> <span class=\"token function\">uuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n         <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n         <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>list\n       <span class=\"token punctuation\">]</span>\n     <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n   <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n     <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Now we have to find a way to combine those reducers into one. There are different approaches to doing that:</p>\n<ul>\n<li>each reducer can modify the whole state (1)</li>\n<li>each reducer modifies only its parts of the state (2) </li>\n</ul>\n<p>Which one is better?</p>\n<p>@1 If reducer is able to modify every single property in state object then we might get into a situation when two reducers try to modify the same property os the state while responding to the same action.</p>\n<p>@2 W don’t have a problem from @1 but in this case, it would be useful to have dispatcher available inside reducer.</p>\n<p>We’re going to take first one of them. There is a reason for that, we’re considering only small to small/middle apps where your state definition can be fitted on one screen. Besides that, if you want to go with the second option, chose Redux instead.</p>\n<h2 id=\"data-flow\"><a href=\"#data-flow\" aria-label=\"data flow permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Data flow</h2>\n<p>After we decided that we want to use @1 approach, we have to imagine how our action flow will look from now</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">:</span> AppState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> ActionType</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>listReducer<span class=\"token punctuation\">,</span> favouritesReducer<span class=\"token punctuation\">,</span> settingsReducer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> reducer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    state\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"/react-simple-reducers-f7c2af25aef52602b8181bcadc37e4e9.gif\" alt=\"Object\"></p>\n<p>If you follow the path, <strong>AppState Reducer</strong> is getting <code class=\"language-text\">ADD_TO_FAV</code> action with some payload. After that, it iterates through every single reducer in it and allows them to modify state. Everything looks great right? Not exactly, I’ve added all those reducers in the right order. If you change the order to be sth different you can get a different result.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">state<span class=\"token punctuation\">:</span> AppState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">:</span> ActionType</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>favouritesReducer<span class=\"token punctuation\">,</span> listReducer<span class=\"token punctuation\">,</span> settingsReducer<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">acc<span class=\"token punctuation\">,</span> reducer</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">reducer</span><span class=\"token punctuation\">(</span>acc<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    state\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/17ff98b6ccb5cc07dd3fb34745e28f91/b2bce/reorder-reducers.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 883px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 43.374858437146095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACGElEQVQoz5WQO28TQRSFByRCChBSREAKBQ01gQjR8QtoAhRREEgEemhTABHwC6h4VcAPAIkIBTuKIisPEjsY412vvQ+vvTv7IrZj7GSzY3s5zCwVSBSMdDR3vnt05s4QvJseIn8tPDs/hNbrw4cIOcmPp7nGuE5dPkaOwHk7DEIO/OHn6qceDmP+7hiZC3FQCTBZaeCm2sANXk+tmjgqjBtq99I3O75T3sb1r/X+7c96eEbwvB2Pc/+M1sQ0783krcE5wQcLsyMka/bG81oDedVHtkSh+gySzSaFQXFYxQgY1gsmvD1AcfsvBC/Wd9OaF2GNc533+TkjeJR6NEo2KS6opjnQ5XSsS58Y9WxILq4Jg+m3y4G1iWLuw367qUH12CvBNbqT8usbkHPvQ6e6Bt1tJ4GD9INRkrUxoTuN2DBk1Gqlvtfqokjjq8KgOh3F82uCs2a7AcWJXgpedlkq4BPrbjfyuhA8CewtPh4lOYoJzXL6cmE51pUVRoMAkoMrSSBty3Zdgqnn9oPvFnjQ899f0Vugu0DF/xnaHaDk9JYFZ+knPNCMLgrohYDYWzFQtMKpZBKraQVeGVZ1C51uAIVGb5JAt7fyA4CxDexABLJcErjIA9ergxMyZR9lGq2WKMvwOlOo7Z0VhlK9+VQ35KxhFJd0U9/iF90SXLKjWT7VF64lLs6j+8mTU3PHyf8uPtC/e/P3Rn4B5SeiMVTNMFoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Object\"\n        title=\"\"\n        src=\"/static/17ff98b6ccb5cc07dd3fb34745e28f91/b2bce/reorder-reducers.png\"\n        srcset=\"/static/17ff98b6ccb5cc07dd3fb34745e28f91/0783d/reorder-reducers.png 240w,\n/static/17ff98b6ccb5cc07dd3fb34745e28f91/782f4/reorder-reducers.png 480w,\n/static/17ff98b6ccb5cc07dd3fb34745e28f91/b2bce/reorder-reducers.png 883w\"\n        sizes=\"(max-width: 883px) 100vw, 883px\"\n      />\n  </span>\n  </a></p>\n<p><img src=\"/reorder-reducers-0a98a1c7804626073bc5849ae0d7362c.gif\" alt=\"Object\"></p>\n<p><a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/8d6858ca37a369ea8b8794c529bb2201/9fa35/different-states.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 47.712418300653596%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABXklEQVQoz21S2ZKCQAz0o+f/lvJNrFrBpQQ8EMWrFMULB1ZrepMpYFF4CGSSTic9mc7tdgPb5XLB9Xqtm+I4/eVkMhGLxUKladqK5fP9fsd6vUbHcRzs93sdYOOiwpSUkmPycDgIwinf93E6nXS+jmWfsbvdDh3+cIcsy7Q9Ho+SXBW+pOnEdDpVZeMW7D9hEASgAsznc7C/2WzKrnpCkijjOBZhGCrG0L/CcoOStCLs9XoYDAYYjUYaTMUNQjLheZ4yTROWZYGlL5dLnM/npuQkSZDRIc9zvF4vLaUumQokTSRWq5XiBeSU/yXs8/lEccfvhLZtYzwew6Wurutq+Z8T0iIE5RQv0K9ht9ttU/KXYeCbpIQkfTab4Xg8lqCKkHxhW5Yyul389PsIh0MEdD28zIbkUqIsgm1bjqJI0NXoBim9Q0kk2i/I3girt1RL1iUzIW1T8EOvcE1sRfgHZZrsVMas1fMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    ></span>\n    <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;box-shadow:inset 0px 0px 0px 400px white;\"\n        alt=\"Object\"\n        title=\"\"\n        src=\"/static/8d6858ca37a369ea8b8794c529bb2201/f570d/different-states.png\"\n        srcset=\"/static/8d6858ca37a369ea8b8794c529bb2201/0783d/different-states.png 240w,\n/static/8d6858ca37a369ea8b8794c529bb2201/782f4/different-states.png 480w,\n/static/8d6858ca37a369ea8b8794c529bb2201/f570d/different-states.png 960w,\n/static/8d6858ca37a369ea8b8794c529bb2201/9fa35/different-states.png 1071w\"\n        sizes=\"(max-width: 960px) 100vw, 960px\"\n      />\n  </span>\n  </a></p>\n<p>As you can see in this case object added into <strong>favourites</strong> list is not the same object as it is in <strong>list</strong>. Because <strong>listReducer</strong> was called second, it couldn’t modify list item before it was copied into <strong>favourites</strong>. We could design that structure in the better way so we’re not duplicating that flag (<code class=\"language-text\">isInFavourites</code>), but it was one of the easiest ways to show what kind of problems you might occur when dealing with your reducers (and sometimes it could take a while to debug it).</p>\n<p>One of the quick fixes would be just to always set <code class=\"language-text\">isInFavourites</code> to <code class=\"language-text\">true</code> when creating a copy of the object from the list.</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span>\n        favourites<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            <span class=\"token operator\">...</span>el<span class=\"token punctuation\">,</span>\n            isInFavourites<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token operator\">...</span>state<span class=\"token punctuation\">.</span>favourites\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>We’ve managed to split our mono-reducer into a couple of smaller reducers. This approach allows us to separate logic for a different part of the state in the app. It has some disadvantages but because we’re not dealing with really complicated states in small apps, removing complex state managers benefits us more. Here is a full code again (but you probably already gone through it either way :p ).</p>\n<p><a href=\"https://codesandbox.io/s/mutable-dust-yggp9?fontsize=14\">https://codesandbox.io/s/mutable-dust-yggp9?fontsize=14</a></p>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/2019/09/react-state-management-without-libraries-with-hooks-part-2"}}}