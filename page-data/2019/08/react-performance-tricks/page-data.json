{"componentChunkName":"component---src-templates-post-template-js","path":"/2019/08/react-performance-tricks","result":{"data":{"markdownRemark":{"fields":{"slug":"/2019/08/react-performance-tricks","tagSlugs":["/tag/libraries/","/tag/javascript/","/tag/performance/","/tag/react/"],"readTime":{"text":"20 min read","minutes":19.633333333333333}},"frontmatter":{"description":"How React is able to execute so fast and still remain flexible for a developer?","tags":["Libraries","Javascript","Performance","React"],"date":"2019-08-10","title":"React performance tricks"},"html":"<blockquote>\n<p>This post requires a basic knowledge about Shapes and Inline Cache. If you didn’t read <a href=\"/2019/08/v-8-function-optimization\">V8 function optimization</a>, it might be difficult to follow this one.</p>\n</blockquote>\n<p>Every time someones talk about “performance” in React it’s usually about virtual DOM. It is an important piece of react but we will focus on sth else today (still connected).</p>\n<h2 id=\"fibers\"><a href=\"#fibers\" aria-label=\"fibers permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Fibers</h2>\n<p>In 2017 on F8 conference React announced a major rewrite of their core algorithm. That’s where <code>Fiber</code> comes from. But what that exactly is?</p>\n<p>A <code>Fiber</code> is work on a Component that needs to be done or was done. (another words “wrapper for processing”). There are different ways to create Fibers but all of them have the same data structure (that’s important for us). These are only some of them:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">createWorkInProgress</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">createHostRootFiber</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">createFiberFromTypeAndProps</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">createFiberFromElement</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">createFiberFromFragment</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">...</span></span></span></code></pre>\n<blockquote>\n<p>You can check how Fiber looks <a href=\"https://github.com/facebook/react/blob/master/packages/react-reconciler/src/ReactFiber.js#L118\" target=\"_blank\">right here</a></p>\n</blockquote>\n<p>We’re not going to go deep into Fiber internals (maybe next time). What is important is that React uses those containers instead of operating on components directly.</p>\n<p>Now let’s see that react does when we return JSX:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk20\">&lt;</span><span class=\"mtk7 mtkb\">Layout</span><span class=\"mtk20\">&gt;</span><span class=\"mtk6\">{</span><span class=\"mtk7\">children</span><span class=\"mtk6\">}</span><span class=\"mtk20\">&lt;/</span><span class=\"mtk7 mtkb\">Layout</span><span class=\"mtk20\">&gt;</span><span class=\"mtk6\">;</span></span></span></code></pre>\n<p>that transforms it into:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">React</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">createElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">Layout</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">props</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">children</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span></code></pre>\n<p>and creates ReactElement which is just another kind of container.</p>\n<h2 id=\"simplify-react-internals\"><a href=\"#simplify-react-internals\" aria-label=\"simplify react internals permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Simplify React internals</h2>\n<p>I’m going to simplify React’s internal structure a little bit, to make it easier to understand what it does. Besides that, I will use a class instead of function for <code>FiberNode</code>:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Component</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">constructor</span><span class=\"mtk6\">()</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">this</span><span class=\"mtk6\">.</span><span class=\"mtk7\">name</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">Component</span><span class=\"mtk6\">&#39;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtkb\">render</span><span class=\"mtk6\">()</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">MyComponent1</span><span class=\"mtk1\"> </span><span class=\"mtk10\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Component</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtkb\">render</span><span class=\"mtk6\">()</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">&lt;span&gt;Test 1&lt;/span&gt;</span><span class=\"mtk6\">&#39;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">MyComponent2</span><span class=\"mtk1\"> </span><span class=\"mtk10\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Component</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtkb\">render</span><span class=\"mtk6\">()</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">&lt;span&gt;Test 2&lt;/span&gt;</span><span class=\"mtk6\">&#39;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">MyComponent3</span><span class=\"mtk1\"> </span><span class=\"mtk10\">extends</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Component</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk9 mtkb\">render</span><span class=\"mtk6\">()</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">&lt;span&gt;Test 3&lt;/span&gt;</span><span class=\"mtk6\">&#39;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">function</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createElement</span><span class=\"mtk6\">(</span><span class=\"mtk7\">element</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk6\">...</span><span class=\"mtk7\">rest</span><span class=\"mtk6\">)</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    type</span><span class=\"mtk6\">:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">element</span><span class=\"mtk6\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span></code></pre>\n<p>That’s our component classes which should look familiar and <code>createElement</code> which returns Element like structure (oversimplified).</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">ReactWorkTags</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  ClassComponent</span><span class=\"mtk6\">:</span><span class=\"mtk1\"> </span><span class=\"mtk5\">1</span><span class=\"mtk6\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  HostComponent</span><span class=\"mtk6\">:</span><span class=\"mtk1\"> </span><span class=\"mtk5\">5</span><span class=\"mtk6\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">};</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">class</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">FiberNode</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">constructor</span><span class=\"mtk6\">(</span><span class=\"mtk7\">tag</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk6\">...</span><span class=\"mtk7\">rest</span><span class=\"mtk6\">)</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk5\">this</span><span class=\"mtk6\">.</span><span class=\"mtk7\">tag</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">tag</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    </span><span class=\"mtk3 mtki\">// Other important staff...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createFiberFromElement</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">function</span><span class=\"mtk6\">(</span><span class=\"mtk7\">element</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk6\">...</span><span class=\"mtk7\">rest</span><span class=\"mtk6\">)</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">  </span><span class=\"mtk3 mtki\">// another simplification, there are different WorkTags</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiberTag</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">typeof</span><span class=\"mtk1\"> </span><span class=\"mtk7\">element</span><span class=\"mtk6\">.</span><span class=\"mtk7\">type</span><span class=\"mtk1\"> </span><span class=\"mtk6\">===</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">string</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk6\">?</span><span class=\"mtk1\"> </span><span class=\"mtk7\">ReactWorkTags</span><span class=\"mtk6\">.</span><span class=\"mtk7\">HostComponent</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      </span><span class=\"mtk6\">:</span><span class=\"mtk1\"> </span><span class=\"mtk7\">ReactWorkTags</span><span class=\"mtk6\">.</span><span class=\"mtk7\">ClassComponent</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">new</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">FiberNode</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiberTag</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk6\">...</span><span class=\"mtk7\">rest</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk7\">fiber</span><span class=\"mtk6\">.</span><span class=\"mtk7\">type</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">element</span><span class=\"mtk6\">.</span><span class=\"mtk7\">type</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">};</span></span></span></code></pre>\n<p>Here we have a definition of our <code>FiberNode</code> and one way we could create it. It’s important to know that when passing our element, FiberNode created from that element has the same shape as any other FiberNode (even if we’re using different component types).</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp1</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">MyComponent1</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp2</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">MyComponent2</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp3</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">MyComponent3</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp4</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createElement</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">div</span><span class=\"mtk6\">&#39;</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber1</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createFiberFromElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp1</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber2</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createFiberFromElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp2</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber3</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createFiberFromElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp3</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber4</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">createFiberFromElement</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp4</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber1</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber2</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber1</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber3</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber1</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber4</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber2</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber3</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber2</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber4</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// true</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber3</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">fiber4</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// true</span></span></span></code></pre>\n<p>What would happen if you just generate those components manually and assign additional properties to it?</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp1</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">new</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">MyComponent1</span><span class=\"mtk1\">()</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp2</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">new</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">MyComponent2</span><span class=\"mtk1\">()</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">%</span><span class=\"mtk9 mtkb\">HaveSameMap</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp1</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">comp2</span><span class=\"mtk1\">))</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk3 mtki\">// false</span></span></span></code></pre>\n<h2 id=\"how-that-helps-us-run-code-faster\"><a href=\"#how-that-helps-us-run-code-faster\" aria-label=\"how that helps us run code faster permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>How that helps us run code faster</h2>\n<p>As you might know, every time there is a change in React, it has to go through the reconciliation process. Reconciliation is using fibers to figure out the next tree. How does it works?</p>\n<p>Inside <code>ReactFiberWorkLoop</code> everything goes into <code>workLoopSync</code> (or <code>workLoop</code>). After that <code>performUnitOfWork</code> is called with “top” Fiber. <code>performUnitOfWork</code> is doing one of three things:</p>\n<ul>\n<li>nothing</li>\n<li>calls <code>beginWork</code> with current <code>unitOfWork</code> (Fiber)</li>\n<li>calls <code>completeUnitOfWork</code> with current <code>unitOfWork</code> (also Fiber)</li>\n</ul>\n<p>In the end, it returns null or results of one of those two functions (surprise… it’s Fiber).</p>\n<p>From this point, reconciler is just looping over all Fibers using <code>performUnitOfWork</code> and waits until <code>workInProgress</code> is empty.</p>\n<p>What is important is that React not using recursion to go through the tree. They are using simple while loops to avoid having large stacks (maybe if we could get <a href=\"https://github.com/tc39/proposal-ptc-syntax\">PTC</a> into JS that would be different).</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">while(sthToDo !== null) {</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">    sthToDo = doSomeWork(sthToDo)</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">}</span></span></code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 276px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 105.43478260869566%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAADdUlEQVQ4y4WVXWyTZRTHf2/Xda1befeObrANHIyVjXVuDNx0c4xBt66stZvMKFG+3GzBIDFETfDCROFiiZEAg9F9XihLgERvJPIV8MIlZqwjho8LSYwJdyCJ0QT5NNbTt1+0zO0k/5zznPc8/5znPOc8L4gc9ZEX9NIsesXeHgw8JUFPVA92JH3/JrVZ4BBUCdREwNk6tBMtVH/bRNnpl7AKse3rVuaNr8cgtjLkQRmMEYccEI7t+yeD7EdZ2B+bcIgu/UvDnCCVIKNg8fnVOAZ8dBzopoY0iZCGk/GKoEiwQKAKmgSLEgFxQ5RBYBHYT7bQcKSTxqEOXj7owhr53lYpRLHYt26ycNsNynp+pqLrNnbPH+QmuB4ao/q7Brg1H+MDM9lSisoxF45jHorSsx2T4B2XKRG8ELhM1c5JmgSLnyl0OG2jrHMEy/OhVpZ1BgP2iL9lH4o/RF4gRIFAFbvOP01h+ubk7fZh2/09NR+Nk/95kOKC+SwRd4VAYy55NwTXGqP2XRuZQjzvgpvS/h66RlpxS8u0XtyELfL9VBjTOxOYd/2CIpkhmSW0ZBiVHVMpWT73RAjj6759yb7ceglNyNTANJoQ6DGiU6Umds794/rtRkmNLLlvpfDQRurlhj3SLmsGvaz8+Dh5ke/vX8QQqVvEDoRmOPKbv5G55QYFvVcp//RLVh/YSfvh7ThG1pET9KEJafZAN6bAFFX+K5glK6s/RuifiXDShWGqjfzhPpaPvUH56HrqhzdQMfBa6hg2h3UCVWqV0xurV6JuabebJdAEhWdXUXawm3UyLSu/cpLRv1FGz41yeDPKM5f5P2S6/KmR8dCC7Z6F3OslaHdysaTHWvNR7B0oH94F79DsGSbkb5M+dsUTVdT2d+Ic8LL2UBdrzmymNB7zvDpHH9aGo6RPMlP9p5sp+aGeZdMrqK5RqRZXuRS1aFYyvSmnovXYNRn1/S4vyXs/svSDCbSxLyj86VUqVaNO2CiFLJ2VsPda6rpNJmFRGMveURpGnLjlyK5+H84zb7MsHlNknePI225i6b6PaeuvLPhkmPZRJ6ukdZYGu8ge9ZF53I1pTz3yHuk3rcw+x1co232O4v2fkbfnG1Rpj5Lhdl6Uhq4Y3JDah/rv4pU5svOGyTr6OvYRF52CxhN2MtJf6TgiMuRL2jPJf0a0BhLYFb+iAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Object\"\n        title=\"Object\"\n        src=\"/static/409e36567ecc2888ffc80d168b012d0d/0d238/react-tree.png\"\n        srcset=\"/static/409e36567ecc2888ffc80d168b012d0d/0d238/react-tree.png 276w\"\n        sizes=\"(max-width: 276px) 100vw, 276px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<blockquote>\n<p>React has extra optimization for simple “Text” nodes to avoid creating extra elements</p>\n</blockquote>\n<p>That’s where we could spot optimization in React structure.</p>\n<p>Because all of it is complicated enough, let’s check how functions behave when they are called thousands of times with our simplified structure:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">function</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk6\">(</span><span class=\"mtk7\">unitOfWork</span><span class=\"mtk6\">)</span><span class=\"mtk1\"> </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk7\">let</span><span class=\"mtk1\"> </span><span class=\"mtk7\">result</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;&#39;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    </span><span class=\"mtk3 mtki\">// I realize that is stupid but just to make a point of doing sth</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk10\">for</span><span class=\"mtk1\">(</span><span class=\"mtk7\">let</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk6\">=</span><span class=\"mtk5\">0</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk6\">&lt;</span><span class=\"mtk5\">1000</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk1\"> </span><span class=\"mtk6\">+=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">1</span><span class=\"mtk1\">) </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t\t</span><span class=\"mtk7\">result</span><span class=\"mtk1\"> </span><span class=\"mtk6\">+=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">unitOfWork</span><span class=\"mtk6\">.</span><span class=\"mtk7\">name</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk10\">return</span><span class=\"mtk1\"> </span><span class=\"mtk7\">unitOfWork</span><span class=\"mtk6\">.</span><span class=\"mtk7\">nextFiber</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span></code></pre>\n<p>I know we’re not referring to returned <code>unitOfWork</code>, but that’s just to run <code>doSomeWork</code> many times.</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">N</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">100000</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">startComp</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Date</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">now</span><span class=\"mtk1\">()</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">for</span><span class=\"mtk1\">(</span><span class=\"mtk7\">let</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk6\">=</span><span class=\"mtk5\">0</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk6\">&lt;</span><span class=\"mtk7\">N</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk1\"> </span><span class=\"mtk6\">+=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">1</span><span class=\"mtk1\">) </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp1</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp2</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp3</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp4</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">comp5</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;</span><span class=\"mtk4\">test with components:</span><span class=\"mtk6\">&quot;,</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Date</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">now</span><span class=\"mtk1\">() </span><span class=\"mtk6\">-</span><span class=\"mtk1\"> </span><span class=\"mtk7\">startComp</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;</span><span class=\"mtk4\">ms.</span><span class=\"mtk6\">&quot;</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span></code></pre>\n<pre class=\"grvsc-container quiet-light\" data-language=\"javascript\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">N</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">100000</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">const</span><span class=\"mtk1\"> </span><span class=\"mtk7\">startFiber</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Date</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">now</span><span class=\"mtk1\">()</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk10\">for</span><span class=\"mtk1\">(</span><span class=\"mtk7\">let</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk6\">=</span><span class=\"mtk5\">0</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk6\">&lt;</span><span class=\"mtk7\">N</span><span class=\"mtk6\">;</span><span class=\"mtk1\"> </span><span class=\"mtk7\">i</span><span class=\"mtk1\"> </span><span class=\"mtk6\">+=</span><span class=\"mtk1\"> </span><span class=\"mtk5\">1</span><span class=\"mtk1\">) </span><span class=\"mtk6\">{</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber1</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber2</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber3</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber4</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\t</span><span class=\"mtk9 mtkb\">doSomeWork</span><span class=\"mtk1\">(</span><span class=\"mtk7\">fiber5</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7 mtkb\">console</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">log</span><span class=\"mtk1\">(</span><span class=\"mtk6\">&quot;</span><span class=\"mtk4\">test with fibers:</span><span class=\"mtk6\">&quot;,</span><span class=\"mtk1\"> </span><span class=\"mtk7 mtkb\">Date</span><span class=\"mtk6\">.</span><span class=\"mtk9 mtkb\">now</span><span class=\"mtk1\">() </span><span class=\"mtk6\">-</span><span class=\"mtk1\"> </span><span class=\"mtk7\">startFiber</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&quot;</span><span class=\"mtk4\">ms.</span><span class=\"mtk6\">&quot;</span><span class=\"mtk1\">)</span><span class=\"mtk6\">;</span></span></span></code></pre>\n<pre class=\"grvsc-container quiet-light\" data-language=\"\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">test with components: 4186 ms.</span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\">test with fibers: 2431 ms.</span></span></code></pre>\n<p>Why the results are different? Mainly because of <code>FiberNode</code> wrapper. Every time function is called V8 creates sth called <code>Inline Cache</code> (IC). ICs are used to optimize function execution when object with the same <code>Shape</code> is passed into it. As you might remember our fibers have the same map:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">console.log(%HaveSameMap(fiber1, fiber2)); // true</span></span></code></pre>\n<p>and our components haven’t</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\">console.log(%HaveSameMap(comp1, comp2)); // false</span></span></code></pre>\n<p>Because of that simple thing, V8 cannot optimize <code>doSomeWork</code> for components</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 363px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.27823691460055%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACP0lEQVQ4y32UW5PhUBSF+///EFOqvIx+8eBlujRmemZ0EgTRRCIk4jKuuWHN3hsZjOpTdUROju/svdaKp9LrK1q6Dh5xHGE4HCKMYlzGbrfDfr/HYrHAaDSG4ziwbRuz2QyHw0H2HI/HdP+TqmrofXzIzXa7pc0WQQKEYUgHxFgtl7I+mUzguq5ceS5p/SGQP8YjB/n8VzhUQbNRx6/fNeh6Cx3DwGAwgEXTNE2sVqu06su4hqVAw+iiUCjIQhKFqFSrmM7m6SauZLPZwKPKyuVXaFpdZLgA/6swDHakz4iqasKyHQTU7sDsYzQei16s63Tqw/d9rNdrHM6A4901BepkypdMRqDcWqlUgqKomM/nMhloWZa0Xy6XBXpd3XWVAmSRG43GqWVymn+8C8KblqMoEhBD2TBeu9eP7wXoUmuK8o4f36uovStQVRWtVovat/H28w3dbpd07qDZbEpsxCjLTqHXcAG2Ox1yOY+TnluUKxWMXS89OaTq2GGOzcvLN5HF7Jsw2i2omgadDg/D6B9ws1nTiQMSfSrVup6HiX8ywaPvrKPvT8iYWVoRZzRJYsRJcpNHAXKwn5/zpKUvblarFejtjmjLLTKUde31evI2cajvx03LDdIml8ulDznc1tBJ7xOqglsOw4AOnMr81GUWO5vNnjcdoKmK5PEygiDAnILOYAm45z18S1JgvV5HhnJ4AapKDQNreAPkPwPXc+XqUF4/BfZ6fRSLxYsaFBPjxuXo7DKbs1z+SZ89Av4F3TRx8/Ix77gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Object\"\n        title=\"Object\"\n        src=\"/static/b7ec4a5ca4e32472e6f1966a6b62d671/e99e2/deoptimized-function.png\"\n        srcset=\"/static/b7ec4a5ca4e32472e6f1966a6b62d671/733ef/deoptimized-function.png 320w,\n/static/b7ec4a5ca4e32472e6f1966a6b62d671/e99e2/deoptimized-function.png 363w\"\n        sizes=\"(max-width: 363px) 100vw, 363px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>but it can for fibers</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.81564245810056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9klEQVQY032QzW6DMBCE8/6P0bxA20tzag6NuHCuI7AJYAO1w58A0SAUmHodlUMPHWmk9Wr9edY7WI1DhySV+GQMYcihlERRFMjyHEIIqCxDZq2UQtM0MMagrhv81bqu2FFBl/b7J4zjiDzPcDi8gYuLPX+jLEtorR2EnRk8z0MURQiDEEkSg3Nuw6RYlsVBHbDregcl3W4PSNu2uN8fQ/M8u8coHcH7vneu6xpVVdl+69JtwKvROB7fEdh14/gC3/cRBAFEJMDYGamUSO2XlNcS/2lbOU4kXl+eXXOyCU+nD3xpsw1O04RhGFxNKckkWpMgvyb9AGKXeICqH5csAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Object\"\n        title=\"Object\"\n        src=\"/static/327d36e88b4b2782052da6bf1002524c/63558/optimized-function.png\"\n        srcset=\"/static/327d36e88b4b2782052da6bf1002524c/733ef/optimized-function.png 320w,\n/static/327d36e88b4b2782052da6bf1002524c/63558/optimized-function.png 358w\"\n        sizes=\"(max-width: 358px) 100vw, 358px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>If you look on screenshots above, you can notice that first time V8 goes through <code>premonomorphic (.) -> monomorphic (1) -> polymorphic (P)-> megamorphic (N)</code> states but second one stays in <code>premonomorphic (.) -> monomorphic (1)</code> state. In my <a href=\"/2019/08/v-8-function-optimization#back-to-our-function\">previous post</a> I’ve described how optimization works in V8. Here we have to deal with <strong>Megamorphic</strong> function and that means it won’t be optimized by the engine, on the other hand we have <strong>Monomorphic</strong> function which is optimized for a given Shape (Fiber’s Shape). So even with an extra layer (more complicated object), function might execute faster.</p>\n<h2 id=\"conclusions\"><a href=\"#conclusions\" aria-label=\"conclusions permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusions</h2>\n<p>This is just one of many optimizations done inside React codebase. Reason for describing this one is because it’s useful outside React. Angular is using the same approach with sth called <code>View Nodes</code>. You might even want to implement this kind of structure inside our own application.</p>\n<p>I have to apologize for oversimplifying React structure. I really encourage you to check it out and see how workLoop actually works under the hood. My point was to show that even if you have to process a lot of different components, there is a way to speed up function execution by creating “special” containers instead of passing components directly.</p>\n<p>If you want to run that code on your machine <a href=\"https://gist.github.com/burnpiro/fec834b8473ffecd439ae5c98855bc61\" target=\"_blank\">check out this gist</a>. Feel free to modify components or <code>FiberNode</code> implementation and see what happens.</p>\n<p>And ofc have a nice rest of the day :)</p>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .quiet-light { background-color: #F5F5F5; }\n  .quiet-light .mtki { font-style: italic; }\n  .quiet-light .mtkb { font-weight: bold; }\n  .quiet-light .mtk7 { color: #7A3E9D; }\n  .quiet-light .mtk6 { color: #777777; }\n  .quiet-light .mtk10 { color: #4B69C6; }\n  .quiet-light .mtk1 { color: #333333; }\n  .quiet-light .mtk20 { color: #91B3E0; }\n  .quiet-light .mtk9 { color: #AA3731; }\n  .quiet-light .mtk5 { color: #9C5D27; }\n  .quiet-light .mtk4 { color: #448C27; }\n  .quiet-light .mtk3 { color: #AAAAAA; }\n  .quiet-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n</style>","htmlAst":{"type":"root","children":[{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This post requires a basic knowledge about Shapes and Inline Cache. If you didn’t read "},{"type":"element","tagName":"a","properties":{"href":"/2019/08/v-8-function-optimization"},"children":[{"type":"text","value":"V8 function optimization"}]},{"type":"text","value":", it might be difficult to follow this one."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Every time someones talk about “performance” in React it’s usually about virtual DOM. It is an important piece of react but we will focus on sth else today (still connected)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"fibers"},"children":[{"type":"element","tagName":"a","properties":{"href":"#fibers","ariaLabel":"fibers permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Fibers"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In 2017 on F8 conference React announced a major rewrite of their core algorithm. That’s where "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Fiber"}]},{"type":"text","value":" comes from. But what that exactly is?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"A "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Fiber"}]},{"type":"text","value":" is work on a Component that needs to be done or was done. (another words “wrapper for processing”). There are different ways to create Fibers but all of them have the same data structure (that’s important for us). These are only some of them:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"0"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"createWorkInProgress"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"createHostRootFiber"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"createFiberFromTypeAndProps"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"createFiberFromElement"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"createFiberFromFragment"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"..."}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can check how Fiber looks "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/facebook/react/blob/master/packages/react-reconciler/src/ReactFiber.js#L118","target":"_blank"},"children":[{"type":"text","value":"right here"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"We’re not going to go deep into Fiber internals (maybe next time). What is important is that React uses those containers instead of operating on components directly."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Now let’s see that react does when we return JSX:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"1"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk20"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Layout"}]},{"type":"element","tagName":"span","properties":{"className":["mtk20"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"children"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tagName":"span","properties":{"className":["mtk20"]},"children":[{"type":"text","value":"</"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Layout"}]},{"type":"element","tagName":"span","properties":{"className":["mtk20"]},"children":[{"type":"text","value":">"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"that transforms it into:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"2"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"React"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"Layout"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"props"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"children"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"and creates ReactElement which is just another kind of container."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"simplify-react-internals"},"children":[{"type":"element","tagName":"a","properties":{"href":"#simplify-react-internals","ariaLabel":"simplify react internals permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Simplify React internals"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I’m going to simplify React’s internal structure a little bit, to make it easier to understand what it does. Besides that, I will use a class instead of function for "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"FiberNode"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"3"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"class"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Component"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"Component"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"';"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"render"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"class"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"MyComponent1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"extends"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Component"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"render"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"<span>Test 1</span>"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"';"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"class"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"MyComponent2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"extends"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Component"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"render"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"<span>Test 2</span>"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"';"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"class"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"MyComponent3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"extends"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Component"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"render"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"<span>Test 3</span>"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"';"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"function"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"element"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"..."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"rest"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    type"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"element"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"};"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"That’s our component classes which should look familiar and "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"createElement"}]},{"type":"text","value":" which returns Element like structure (oversimplified)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"4"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"ReactWorkTags"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  ClassComponent"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  HostComponent"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"5"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"};"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"class"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"FiberNode"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"constructor"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"tag"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"..."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"rest"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"tag"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"tag"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// Other important staff..."}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createFiberFromElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"function"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"element"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"..."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"rest"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// another simplification, there are different WorkTags"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiberTag"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"typeof"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"element"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"==="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"string"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"      "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"?"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"ReactWorkTags"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"HostComponent"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"      "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":":"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"ReactWorkTags"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"ClassComponent"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"new"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"FiberNode"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiberTag"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"..."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"rest"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"element"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"type"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"  "}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"};"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Here we have a definition of our "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"FiberNode"}]},{"type":"text","value":" and one way we could create it. It’s important to know that when passing our element, FiberNode created from that element has the same shape as any other FiberNode (even if we’re using different component types)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"5"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"MyComponent1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"MyComponent2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"MyComponent3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"div"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createFiberFromElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createFiberFromElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createFiberFromElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"createFiberFromElement"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// true"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// true"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// true"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// true"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// true"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// true"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"What would happen if you just generate those components manually and assign additional properties to it?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"6"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"new"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"MyComponent1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"new"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"MyComponent2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"%"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"HaveSameMap"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"))"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// false"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"how-that-helps-us-run-code-faster"},"children":[{"type":"element","tagName":"a","properties":{"href":"#how-that-helps-us-run-code-faster","ariaLabel":"how that helps us run code faster permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"How that helps us run code faster"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"As you might know, every time there is a change in React, it has to go through the reconciliation process. Reconciliation is using fibers to figure out the next tree. How does it works?"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Inside "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"ReactFiberWorkLoop"}]},{"type":"text","value":" everything goes into "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"workLoopSync"}]},{"type":"text","value":" (or "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"workLoop"}]},{"type":"text","value":"). After that "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"performUnitOfWork"}]},{"type":"text","value":" is called with “top” Fiber. "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"performUnitOfWork"}]},{"type":"text","value":" is doing one of three things:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"nothing"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"calls "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"beginWork"}]},{"type":"text","value":" with current "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"unitOfWork"}]},{"type":"text","value":" (Fiber)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"calls "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"completeUnitOfWork"}]},{"type":"text","value":" with current "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"unitOfWork"}]},{"type":"text","value":" (also Fiber)"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"In the end, it returns null or results of one of those two functions (surprise… it’s Fiber)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"From this point, reconciler is just looping over all Fibers using "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"performUnitOfWork"}]},{"type":"text","value":" and waits until "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"workInProgress"}]},{"type":"text","value":" is empty."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"What is important is that React not using recursion to go through the tree. They are using simple while loops to avoid having large stacks (maybe if we could get "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/tc39/proposal-ptc-syntax"},"children":[{"type":"text","value":"PTC"}]},{"type":"text","value":" into JS that would be different)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"","dataIndex":"7"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"while(sthToDo !== null) {"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    sthToDo = doSomeWork(sthToDo)"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"}"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 276px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 105.43478260869566%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAYAAABG1c6oAAAACXBIWXMAAAsSAAALEgHS3X78AAADdUlEQVQ4y4WVXWyTZRTHf2/Xda1befeObrANHIyVjXVuDNx0c4xBt66stZvMKFG+3GzBIDFETfDCROFiiZEAg9F9XihLgERvJPIV8MIlZqwjho8LSYwJdyCJ0QT5NNbTt1+0zO0k/5zznPc8/5znPOc8L4gc9ZEX9NIsesXeHgw8JUFPVA92JH3/JrVZ4BBUCdREwNk6tBMtVH/bRNnpl7AKse3rVuaNr8cgtjLkQRmMEYccEI7t+yeD7EdZ2B+bcIgu/UvDnCCVIKNg8fnVOAZ8dBzopoY0iZCGk/GKoEiwQKAKmgSLEgFxQ5RBYBHYT7bQcKSTxqEOXj7owhr53lYpRLHYt26ycNsNynp+pqLrNnbPH+QmuB4ao/q7Brg1H+MDM9lSisoxF45jHorSsx2T4B2XKRG8ELhM1c5JmgSLnyl0OG2jrHMEy/OhVpZ1BgP2iL9lH4o/RF4gRIFAFbvOP01h+ubk7fZh2/09NR+Nk/95kOKC+SwRd4VAYy55NwTXGqP2XRuZQjzvgpvS/h66RlpxS8u0XtyELfL9VBjTOxOYd/2CIpkhmSW0ZBiVHVMpWT73RAjj6759yb7ceglNyNTANJoQ6DGiU6Umds794/rtRkmNLLlvpfDQRurlhj3SLmsGvaz8+Dh5ke/vX8QQqVvEDoRmOPKbv5G55QYFvVcp//RLVh/YSfvh7ThG1pET9KEJafZAN6bAFFX+K5glK6s/RuifiXDShWGqjfzhPpaPvUH56HrqhzdQMfBa6hg2h3UCVWqV0xurV6JuabebJdAEhWdXUXawm3UyLSu/cpLRv1FGz41yeDPKM5f5P2S6/KmR8dCC7Z6F3OslaHdysaTHWvNR7B0oH94F79DsGSbkb5M+dsUTVdT2d+Ic8LL2UBdrzmymNB7zvDpHH9aGo6RPMlP9p5sp+aGeZdMrqK5RqRZXuRS1aFYyvSmnovXYNRn1/S4vyXs/svSDCbSxLyj86VUqVaNO2CiFLJ2VsPda6rpNJmFRGMveURpGnLjlyK5+H84zb7MsHlNknePI225i6b6PaeuvLPhkmPZRJ6ukdZYGu8ge9ZF53I1pTz3yHuk3rcw+x1co232O4v2fkbfnG1Rpj5Lhdl6Uhq4Y3JDah/rv4pU5svOGyTr6OvYRF52CxhN2MtJf6TgiMuRL2jPJf0a0BhLYFb+iAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Object","title":"Object","src":"/static/409e36567ecc2888ffc80d168b012d0d/0d238/react-tree.png","srcSet":["/static/409e36567ecc2888ffc80d168b012d0d/0d238/react-tree.png 276w"],"sizes":["(max-width:","276px)","100vw,","276px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"React has extra optimization for simple “Text” nodes to avoid creating extra elements"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"That’s where we could spot optimization in React structure."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Because all of it is complicated enough, let’s check how functions behave when they are called thousands of times with our simplified structure:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"8"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"function"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"unitOfWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"let"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"result"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"'';"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"    "}]},{"type":"element","tagName":"span","properties":{"className":["mtk3","mtki"]},"children":[{"type":"text","value":"// I realize that is stupid but just to make a point of doing sth"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"let"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"1000"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"+="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"result"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"+="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"unitOfWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"name"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"return"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"unitOfWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"nextFiber"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I know we’re not referring to returned "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"unitOfWork"}]},{"type":"text","value":", but that’s just to run "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"text","value":" many times."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"9"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"100000"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"startComp"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Date"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"let"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"+="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"comp5"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"test with components:"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Date"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"() "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"startComp"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"ms."}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"javascript","dataIndex":"10"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"100000"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"const"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"startFiber"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Date"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"()"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk10"]},"children":[{"type":"text","value":"for"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"let"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"="}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"<"}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"N"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"i"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"+="}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk5"]},"children":[{"type":"text","value":"1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"{"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber1"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber2"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber3"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber4"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"\t"}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"fiber5"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"}"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"test with fibers:"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7","mtkb"]},"children":[{"type":"text","value":"Date"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"."}]},{"type":"element","tagName":"span","properties":{"className":["mtk9","mtkb"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"() "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"-"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"startFiber"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":","}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"ms."}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":"\""}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":")"}]},{"type":"element","tagName":"span","properties":{"className":["mtk6"]},"children":[{"type":"text","value":";"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"","dataIndex":"11"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"test with components: 4186 ms."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"test with fibers: 2431 ms."}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Why the results are different? Mainly because of "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"FiberNode"}]},{"type":"text","value":" wrapper. Every time function is called V8 creates sth called "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Inline Cache"}]},{"type":"text","value":" (IC). ICs are used to optimize function execution when object with the same "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"Shape"}]},{"type":"text","value":" is passed into it. As you might remember our fibers have the same map:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"","dataIndex":"12"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"console.log(%HaveSameMap(fiber1, fiber2)); // true"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"and our components haven’t"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","quiet-light"],"dataLanguage":"","dataIndex":"13"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"console.log(%HaveSameMap(comp1, comp2)); // false"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Because of that simple thing, V8 cannot optimize "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"doSomeWork"}]},{"type":"text","value":" for components"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 363px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 73.27823691460055%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACP0lEQVQ4y32UW5PhUBSF+///EFOqvIx+8eBlujRmemZ0EgTRRCIk4jKuuWHN3hsZjOpTdUROju/svdaKp9LrK1q6Dh5xHGE4HCKMYlzGbrfDfr/HYrHAaDSG4ziwbRuz2QyHw0H2HI/HdP+TqmrofXzIzXa7pc0WQQKEYUgHxFgtl7I+mUzguq5ceS5p/SGQP8YjB/n8VzhUQbNRx6/fNeh6Cx3DwGAwgEXTNE2sVqu06su4hqVAw+iiUCjIQhKFqFSrmM7m6SauZLPZwKPKyuVXaFpdZLgA/6swDHakz4iqasKyHQTU7sDsYzQei16s63Tqw/d9rNdrHM6A4901BepkypdMRqDcWqlUgqKomM/nMhloWZa0Xy6XBXpd3XWVAmSRG43GqWVymn+8C8KblqMoEhBD2TBeu9eP7wXoUmuK8o4f36uovStQVRWtVovat/H28w3dbpd07qDZbEpsxCjLTqHXcAG2Ox1yOY+TnluUKxWMXS89OaTq2GGOzcvLN5HF7Jsw2i2omgadDg/D6B9ws1nTiQMSfSrVup6HiX8ywaPvrKPvT8iYWVoRZzRJYsRJcpNHAXKwn5/zpKUvblarFejtjmjLLTKUde31evI2cajvx03LDdIml8ulDznc1tBJ7xOqglsOw4AOnMr81GUWO5vNnjcdoKmK5PEygiDAnILOYAm45z18S1JgvV5HhnJ4AapKDQNreAPkPwPXc+XqUF4/BfZ6fRSLxYsaFBPjxuXo7DKbs1z+SZ89Av4F3TRx8/Ix77gAAAAASUVORK5CYII='); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Object","title":"Object","src":"/static/b7ec4a5ca4e32472e6f1966a6b62d671/e99e2/deoptimized-function.png","srcSet":["/static/b7ec4a5ca4e32472e6f1966a6b62d671/733ef/deoptimized-function.png 320w","/static/b7ec4a5ca4e32472e6f1966a6b62d671/e99e2/deoptimized-function.png 363w"],"sizes":["(max-width:","363px)","100vw,","363px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"but it can for fibers"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-wrapper"],"style":"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;"},"children":[{"type":"text","value":"\n      "},{"type":"element","tagName":"span","properties":{"className":["gatsby-resp-image-background-image"],"style":"padding-bottom: 26.81564245810056%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA9klEQVQY032QzW6DMBCE8/6P0bxA20tzag6NuHCuI7AJYAO1w58A0SAUmHodlUMPHWmk9Wr9edY7WI1DhySV+GQMYcihlERRFMjyHEIIqCxDZq2UQtM0MMagrhv81bqu2FFBl/b7J4zjiDzPcDi8gYuLPX+jLEtorR2EnRk8z0MURQiDEEkSg3Nuw6RYlsVBHbDregcl3W4PSNu2uN8fQ/M8u8coHcH7vneu6xpVVdl+69JtwKvROB7fEdh14/gC3/cRBAFEJMDYGamUSO2XlNcS/2lbOU4kXl+eXXOyCU+nD3xpsw1O04RhGFxNKckkWpMgvyb9AGKXeICqH5csAAAAAElFTkSuQmCC'); background-size: cover; display: block;"},"children":[]},{"type":"text","value":"\n  "},{"type":"element","tagName":"img","properties":{"className":["gatsby-resp-image-image"],"alt":"Object","title":"Object","src":"/static/327d36e88b4b2782052da6bf1002524c/63558/optimized-function.png","srcSet":["/static/327d36e88b4b2782052da6bf1002524c/733ef/optimized-function.png 320w","/static/327d36e88b4b2782052da6bf1002524c/63558/optimized-function.png 358w"],"sizes":["(max-width:","358px)","100vw,","358px"],"style":"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;","loading":"lazy"},"children":[]},{"type":"text","value":"\n    "}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you look on screenshots above, you can notice that first time V8 goes through "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"premonomorphic (.) -> monomorphic (1) -> polymorphic (P)-> megamorphic (N)"}]},{"type":"text","value":" states but second one stays in "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"premonomorphic (.) -> monomorphic (1)"}]},{"type":"text","value":" state. In my "},{"type":"element","tagName":"a","properties":{"href":"/2019/08/v-8-function-optimization#back-to-our-function"},"children":[{"type":"text","value":"previous post"}]},{"type":"text","value":" I’ve described how optimization works in V8. Here we have to deal with "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Megamorphic"}]},{"type":"text","value":" function and that means it won’t be optimized by the engine, on the other hand we have "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Monomorphic"}]},{"type":"text","value":" function which is optimized for a given Shape (Fiber’s Shape). So even with an extra layer (more complicated object), function might execute faster."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"conclusions"},"children":[{"type":"element","tagName":"a","properties":{"href":"#conclusions","ariaLabel":"conclusions permalink","className":["anchor"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Conclusions"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"This is just one of many optimizations done inside React codebase. Reason for describing this one is because it’s useful outside React. Angular is using the same approach with sth called "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"View Nodes"}]},{"type":"text","value":". You might even want to implement this kind of structure inside our own application."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"I have to apologize for oversimplifying React structure. I really encourage you to check it out and see how workLoop actually works under the hood. My point was to show that even if you have to process a lot of different components, there is a way to speed up function execution by creating “special” containers instead of passing components directly."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"If you want to run that code on your machine "},{"type":"element","tagName":"a","properties":{"href":"https://gist.github.com/burnpiro/fec834b8473ffecd439ae5c98855bc61","target":"_blank"},"children":[{"type":"text","value":"check out this gist"}]},{"type":"text","value":". Feel free to modify components or "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"FiberNode"}]},{"type":"text","value":" implementation and see what happens."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"And ofc have a nice rest of the day :)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .quiet-light { background-color: #F5F5F5; }\n  .quiet-light .mtki { font-style: italic; }\n  .quiet-light .mtkb { font-weight: bold; }\n  .quiet-light .mtk7 { color: #7A3E9D; }\n  .quiet-light .mtk6 { color: #777777; }\n  .quiet-light .mtk10 { color: #4B69C6; }\n  .quiet-light .mtk1 { color: #333333; }\n  .quiet-light .mtk20 { color: #91B3E0; }\n  .quiet-light .mtk9 { color: #AA3731; }\n  .quiet-light .mtk5 { color: #9C5D27; }\n  .quiet-light .mtk4 { color: #448C27; }\n  .quiet-light .mtk3 { color: #AAAAAA; }\n  .quiet-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n"}]}],"data":{"quirksMode":false}}}},"pageContext":{"slug":"/2019/08/react-performance-tricks"}}}