{"componentChunkName":"component---src-templates-post-template-js","path":"/2020/08/deng-ai-data-preprocessing","result":{"data":{"markdownRemark":{"fields":{"slug":"/2020/08/deng-ai-data-preprocessing","tagSlugs":["/tag/data-science/","/tag/machine-learning/","/tag/data-analysis/"],"readTime":{"text":"30 min read","minutes":29.483333333333334}},"frontmatter":{"description":"Step by step explanation on how to deal with Kaggle like competitions. What are the things we should focus on and what should be ignored?","tags":["Data Science","MachineLearning","Data Analysis"],"date":"2020-08-03","title":"DengAI - Data preprocessing"},"html":"<figure class=\"image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 67.1875%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAACAQP/2gAMAwEAAhADEAAAAUtmzFZhdKf/xAAYEAEBAQEBAAAAAAAAAAAAAAABAgADMf/aAAgBAQABBQLmM6oSU0+5kd//xAAVEQEBAAAAAAAAAAAAAAAAAAAAEv/aAAgBAwEBPwGUv//EABURAQEAAAAAAAAAAAAAAAAAABAR/9oACAECAQE/AYf/xAAWEAADAAAAAAAAAAAAAAAAAAAAIDH/2gAIAQEABj8CKv8A/8QAGRABAQEBAQEAAAAAAAAAAAAAAREAITFR/9oACAEBAAE/IRmjMPY787gvfcmsq5apd//aAAwDAQACAAMAAAAQX/8A/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EISLP//EABcRAQEBAQAAAAAAAAAAAAAAAAEAEUH/2gAIAQIBAT8QVyxv/8QAGxABAAMBAAMAAAAAAAAAAAAAAQARITFBUZH/2gAIAQEAAT8QPhs0q9i01cFKgnz5ShLYS01+yote0n//2Q==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"ELM-AE\" title=\"ELM-AE\" src=\"/static/2d20cfae1f605d0cf65180ac79337ffb/0781d/main.jpg\" srcset=\"/static/2d20cfae1f605d0cf65180ac79337ffb/5a194/main.jpg 240w,\n/static/2d20cfae1f605d0cf65180ac79337ffb/8a430/main.jpg 480w,\n/static/2d20cfae1f605d0cf65180ac79337ffb/0781d/main.jpg 960w,\n/static/2d20cfae1f605d0cf65180ac79337ffb/e937d/main.jpg 1024w\" sizes=\"(max-width: 960px) 100vw, 960px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n  <figcaption>Mosquito CC BY-NC-ND 2.0. Source: <a href=\"https://www.flickr.com/photos/sanofi-pasteur/5284040324/in/photolist-93W66w-arV2fF-3p8QNh-cnF7KE-cnF7Mj-cnF8a7-3p8RvU-cnF88u-cnF7Nu-arXFfy-cnF7J7-arXFto-arXDno-cnF7Hb-rwLX9d-cnF7UC-yM76y7-cnF7Ps-cnF85Q-cnF84G-cnF7TE-9wSDw-e4U78V-qRQpJa-e8GxDY-d4YEBA-d4YEwu-e8AVyt-e8GoTN-cnF873-4Gq9Y9-cnFty3-cnF7SQ-c3urbq-cnF7RY-qRJm2d-cnF7VL-62BwyV-qRJj2S-r9i7QB-r99a5k-62Bwt8-c3urhL-c3urd5-5xe7XE-pNRXZp-qRSbMx-pocK57-5xe13J-cnF7XY\" target=\"_blank\">flickr user Sanofi Pasteur</a></figcaption>\n</figure>\n<blockquote>\n<p>This article is based on my entry into <a href=\"https://www.drivendata.org/competitions/44/dengai-predicting-disease-spread/\">DengAI competition on the DrivenData platform</a>. I’ve managed to score within 0.2% (14/9069 as on 02 Jun 2020).</p>\n</blockquote>\n<p>In this article I assume that you’re already familiar with <a href=\"https://erdem.pl/2020/07/deng-ai-how-to-approach-data-science-competitions-eda\">DengAI - EDA</a>. You don’t have to read it to understand everything here, but it would be a lot easier if you do.</p>\n<h2 id=\"why-do-we-have-to-preprocess-data\"><a href=\"#why-do-we-have-to-preprocess-data\" aria-label=\"why do we have to preprocess data permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why do we have to preprocess data?</h2>\n<p>When designing ML models we have to remember that some of them are based on gradient method. Problem with the gradient is that it performs better on normalized/scaled data. Let me show an example:</p>\n<figure class=\"image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 38.92857142857143%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABBklEQVQY022Ry27EMAhF8/8f102XlSp10VGbSeMkGJuX8ZBkOrNo7woBx3Dx0A/lotPCY6IlS/9PSDaDpKxi7ZEc1nV1dzVnaaSu6l2oU+lmUQYAOwKpUjYsUM38CddaW/t9rBmXFevaCXrbm0ope1W4MYgV07y/63d+EJE7LPWafj4ROWDVsyyxiVmQWRnVQU0EOtMdZuYWQ4zevq4vl9noSYZYxKmSYA4SGbmhcmfsfsIiYfJ9HF+/Z6fttBryY7cdjtU4J5HLxqCNOJ+To2Fg4i2lj3FuXP8e+TAVJ2QimDCboRM+PWeAaUobYPQR74ogjoyI+w8hxkUjUyBvaVEErvXRcwM7CNQJFdJekwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"gradient descent\" title=\"gradient descent\" src=\"/static/427e5977d9f4bd2543b667aa3fd7a33b/b7c40/feature-scaling.png\" srcset=\"/static/427e5977d9f4bd2543b667aa3fd7a33b/e4891/feature-scaling.png 240w,\n/static/427e5977d9f4bd2543b667aa3fd7a33b/0ce91/feature-scaling.png 480w,\n/static/427e5977d9f4bd2543b667aa3fd7a33b/b7c40/feature-scaling.png 960w,\n/static/427e5977d9f4bd2543b667aa3fd7a33b/3fc71/feature-scaling.png 1400w\" sizes=\"(max-width: 960px) 100vw, 960px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n  <figcaption>Gradient descent examples. Source: <a href=\"https://www.machinelearningman.com/post/best-explanation-batch-gradient-descent-mini-batch-gradient-descent-stochastic-gradient-descent\" target=\"_blank\">Machine Learning Man</a></figcaption>\n</figure>\n<p>On the left side we have dataset that consists of two features and one of them has larger scale than the other. In both cases gradient method works, but it takes a lot less steps to reach optimum when features lies on similar scales (right image).</p>\n<h2 id=\"what-is-a-normalization-and-what-is-scalling\"><a href=\"#what-is-a-normalization-and-what-is-scalling\" aria-label=\"what is a normalization and what is scalling permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is a Normalization and what is Scalling?</h2>\n<h4 id=\"normalization\"><a href=\"#normalization\" aria-label=\"normalization permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://en.wikipedia.org/wiki/Normalization_(statistics)\">Normalization</a></h4>\n<p>In the standard sence, normalization refers to the process of adjusting value distribution range to fit into <strong>&#x3C;-1, 1></strong> (id doesn’t have to be exact -1 to 1 but within the same order of magnitude so the range ). Standard normalization is done by <strong>subtracting mean value from each value in the set and dividing result by the standard diviation</strong>.</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mfrac><mrow><mi>x</mi><mo>−</mo><mi>μ</mi></mrow><mi>σ</mi></mfrac></mrow><annotation encoding=\"application/x-tex\">{\\frac {x-\\mu }{\\sigma }}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.9463300000000001em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603300000000002em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord mathdefault\">μ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></span>\n<h4 id=\"scalling\"><a href=\"#scalling\" aria-label=\"scalling permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><a href=\"https://en.wikipedia.org/wiki/Feature_scaling#Rescaling_(min-max_normalization)\">Scalling</a></h4>\n<p>You can see it called “min-max normalization” but scalling is another value adjustment to fit in range, but this time range is <strong>&#x3C;0, 1></strong>.</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mfrac><mrow><mi>x</mi><mo>−</mo><mtext>min</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mtext>max</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mtext>min</mtext><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">{\\frac  {x-{\\text{min}}(x)}{{\\text{max}}(x)-{\\text{min}}(x)}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">max</span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">min</span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">x</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">min</span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">x</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></span>\n<h2 id=\"normalization-or-scaling\"><a href=\"#normalization-or-scaling\" aria-label=\"normalization or scaling permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Normalization or Scaling?</h2>\n<p>There are two types of operation you can perform on the feature. You can either normalize or scale its values. Which one you choose depends on the feature itself. If you consider features which have some positive and negative values and that values are important, you should perform normalization. On the feature where negative values make no sense, you should apply scalling.</p>\n<p>It’s not always that black and white. Let’s consider feature like temperature. Depends on which scale you choose (Kelvin or Celsius/Fahrenheit) there might be different interpretations what that temperature could be. Kelvin scale is an <strong>absolute thermodynamic temperature scale</strong> (starte with absolute zero and cannot go below that). On the other hand we have scales used IRL where negative numbers are meaningful for us. When the temperature drops below 0 Celsius, water frezes. The same goes for Fahrenheit scale, its 0 degrees describe freazing point of the <a href=\"https://en.wikipedia.org/wiki/Brine\">brine</a> (concentrated solution of salt in water). Stright forward choice would be to scale Kelvins and normalize Celsius and Fahrenheit. That that’s not always work. We can show it on DengAI’s dataset:</p>\n<div class=\"center-all\">\n<table>\n<thead>\n<tr>\n<th></th>\n<th>reanalysis_air_temp_k</th>\n<th>reanalysis_avg_temp_k</th>\n<th>reanalysis_dew_point_temp_k</th>\n<th>reanalysis_tdtr_k</th>\n<th>station_avg_temp_c</th>\n<th>station_diur_temp_rng_c</th>\n<th>station_max_temp_c</th>\n<th>station_min_temp_c</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>count</td>\n<td>1446.00</td>\n<td>1446.00</td>\n<td>1446.00</td>\n<td>1446.00</td>\n<td>1413.00</td>\n<td>1413.00</td>\n<td>1436.00</td>\n<td>1442.00</td>\n</tr>\n<tr>\n<td>mean</td>\n<td>298.70</td>\n<td>299.23</td>\n<td>295.25</td>\n<td>4.90</td>\n<td>27.19</td>\n<td>8.06</td>\n<td>32.45</td>\n<td>22.10</td>\n</tr>\n<tr>\n<td>std</td>\n<td>1.36</td>\n<td>1.26</td>\n<td>1.53</td>\n<td>3.55</td>\n<td>1.29</td>\n<td>2.13</td>\n<td>1.96</td>\n<td>1.57</td>\n</tr>\n<tr>\n<td>min</td>\n<td>294.64</td>\n<td>294.89</td>\n<td>289.64</td>\n<td>1.36</td>\n<td>21.40</td>\n<td>4.53</td>\n<td>26.70</td>\n<td>14.70</td>\n</tr>\n<tr>\n<td>25%</td>\n<td>297.66</td>\n<td>298.26</td>\n<td>294.12</td>\n<td>2.33</td>\n<td>26.30</td>\n<td>6.51</td>\n<td>31.10</td>\n<td>21.10</td>\n</tr>\n<tr>\n<td>50%</td>\n<td>298.65</td>\n<td>299.29</td>\n<td>295.64</td>\n<td>2.86</td>\n<td>27.41</td>\n<td>7.30</td>\n<td>32.80</td>\n<td>22.20</td>\n</tr>\n<tr>\n<td>75%</td>\n<td>299.83</td>\n<td>300.21</td>\n<td>296.46</td>\n<td>7.62</td>\n<td>28.16</td>\n<td>9.57</td>\n<td>33.90</td>\n<td>23.30</td>\n</tr>\n<tr>\n<td>max</td>\n<td>302.20</td>\n<td>302.93</td>\n<td>298.45</td>\n<td>16.03</td>\n<td>30.80</td>\n<td>15.80</td>\n<td>42.20</td>\n<td>25.60</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>Some of the temperatures are in Kelvin scale, and some in Celsius scale. That’s not what is important here. If you look closely you should be able to group those temperatures by type:</p>\n<ul>\n<li>temperature with absolute minimum value</li>\n<li>temperature without absolute minimum value (can be negative)</li>\n</ul>\n<p>An example of the first one is <strong>station_diur_temp_rng_c</strong>. This is something called <a href=\"https://en.wikipedia.org/wiki/Diurnal_temperature_variation\">Diurnal temperature variation</a> and defines a variation between minimum and maximum temperature withing some period of time. That value cannot have negative values (because difference between minimum and maximum cannot be lower than 0). That’s where we should use scalling instead of normalization.</p>\n<p>Another example is <strong>reanalysis_air_temp_k</strong>. It is an air temperature and important feature. We cannot define a minimum value that temperature could get. If we really want there is a arbitrary minimum temperature for each city that we should never get below but that’s not what we want to do. Things like temperature in problems like our might have another meaing when training models. There could be some positive and negative impact of the temperature value. In this case it might be that temperatures below 298K positively affecting number of cases (fewer mosquitos). That’s why we should use normalization for this one.</p>\n<p>After checking an entire dataset we can come up with the list of features to normalize, scale and copy from <a href=\"https://erdem.pl/2020/07/deng-ai-how-to-approach-data-science-competitions-eda#dataset\">our list of features</a>:</p>\n<h4 id=\"normalized-features\"><a href=\"#normalized-features\" aria-label=\"normalized features permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Normalized features</h4>\n<pre class=\"grvsc-container quiet-light\" data-language=\"bash\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_air_temp_k</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_avg_temp_k</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_dew_point_temp_k</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_max_air_temp_k</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_min_air_temp_k</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">station_avg_temp_c</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">station_max_temp_c</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">station_min_temp_c</span><span class=\"mtk6\">&#39;</span></span></span></code></pre>\n<h4 id=\"scaled-features\"><a href=\"#scaled-features\" aria-label=\"scaled features permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Scaled features</h4>\n<pre class=\"grvsc-container quiet-light\" data-language=\"bash\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">station_diur_temp_rng_c</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_tdtr_k</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">precipitation_amt_mm</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_precip_amt_kg_per_m2</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_relative_humidity_percent</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_sat_precip_amt_mm</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">reanalysis_specific_humidity_g_per_kg</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">station_precip_mm</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">year</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">weekofyear</span><span class=\"mtk6\">&#39;</span></span></span></code></pre>\n<h4 id=\"copied-features\"><a href=\"#copied-features\" aria-label=\"copied features permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Copied features</h4>\n<pre class=\"grvsc-container quiet-light\" data-language=\"bash\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">ndvi_ne</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">ndvi_nw</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">ndvi_se</span><span class=\"mtk6\">&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;</span><span class=\"mtk4\">ndvi_sw</span><span class=\"mtk6\">&#39;</span></span></span></code></pre>\n<h2 id=\"why-copy\"><a href=\"#why-copy\" aria-label=\"why copy permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why Copy?</h2>\n<p>If we look at the definition of NDVI index, we can decide there is no reason for scalling or normalizing those values. NDVI values are already in <strong>&#x3C;-1, 1></strong> range. Sometimes we might want to copy values directly like that. Especially when original values are within the same order of magnitude as our normalized features. It might be &#x3C;0,2> or &#x3C;1,4>, but it shouldn’t cause a problem for the model.</p>\n<h2 id=\"the-code\"><a href=\"#the-code\" aria-label=\"the code permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>The code</h2>\n<p>Now we have to write some code to preprocess our data. We’re going to use <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html\">StandardScaler</a> and <a href=\"https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html\">MinMaxScaler</a> from <a href=\"https://scikit-learn.org/stable/\">sklearn</a> library.</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"python\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk10\">import</span><span class=\"mtk1\"> pandas </span><span class=\"mtk10\">as</span><span class=\"mtk1\"> pd</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk10\">from</span><span class=\"mtk1\"> sklearn</span><span class=\"mtk6\">.</span><span class=\"mtk1\">preprocessing </span><span class=\"mtk10\">import</span><span class=\"mtk1\"> StandardScaler</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> MinMaxScaler</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk10\">from</span><span class=\"mtk1\"> data_info </span><span class=\"mtk10\">import</span><span class=\"mtk1\"> cols_to_norm</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> cols_to_scale</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">def</span><span class=\"mtk1\"> </span><span class=\"mtk9 mtkb\">preproc_data</span><span class=\"mtk6\">(</span><span class=\"mtk7\">data</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">norm_cols</span><span class=\"mtk6\">=</span><span class=\"mtk1\">cols_to_norm</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">scale_cols</span><span class=\"mtk6\">=</span><span class=\"mtk1\">cols_to_scale</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk7\">train_scale</span><span class=\"mtk6\">=</span><span class=\"mtk5\">None</span><span class=\"mtk6\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">    :param data: Dataframe</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">    :param norm_cols: List&lt;string&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">    :param scale_cols: List&lt;string&gt;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">    :param train_scale: Dataframe</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"11\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">    :return: Tuple(Dataframe, Dataframe)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"12\"></span><span class=\"grvsc-source\"><span class=\"mtk4\">    </span><span class=\"mtk6\">&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"13\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3 mtki\"># Make a copy, not to modify original data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"14\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    new_data </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> data</span><span class=\"mtk6\">.</span><span class=\"mtk1\">copy</span><span class=\"mtk6\">()</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"15\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> train_scale </span><span class=\"mtk6\">is</span><span class=\"mtk1\"> </span><span class=\"mtk5\">None</span><span class=\"mtk6\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"16\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        train_scale </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> norm_cols</span><span class=\"mtk6\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3 mtki\"># Normalize temp and percipation</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">norm_cols</span><span class=\"mtk6\">]</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> StandardScaler</span><span class=\"mtk6\">().</span><span class=\"mtk1\">fit</span><span class=\"mtk6\">(</span><span class=\"mtk1\">train_scale</span><span class=\"mtk6\">[</span><span class=\"mtk1\">norm_cols</span><span class=\"mtk6\">]).</span><span class=\"mtk1\">transform</span><span class=\"mtk6\">(</span><span class=\"mtk1\">new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">norm_cols</span><span class=\"mtk6\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"20\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">if</span><span class=\"mtk1\"> scale_cols</span><span class=\"mtk6\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3 mtki\"># Scale year and week no but within (0,1)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">scale_cols</span><span class=\"mtk6\">]</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> MinMaxScaler</span><span class=\"mtk6\">(</span><span class=\"mtk7\">feature_range</span><span class=\"mtk6\">=(</span><span class=\"mtk5\">0</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk5\">1</span><span class=\"mtk6\">)).</span><span class=\"mtk1\">fit</span><span class=\"mtk6\">(</span><span class=\"mtk1\">train_scale</span><span class=\"mtk6\">[</span><span class=\"mtk1\">scale_cols</span><span class=\"mtk6\">]).</span><span class=\"mtk1\">transform</span><span class=\"mtk6\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">            new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">scale_cols</span><span class=\"mtk6\">])</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"25\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"26\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk10\">return</span><span class=\"mtk1\"> new_data</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> train_scale</span></span></span></code></pre>\n<p>As an input to our function we expect to send 3 or 4 variables. When dealing with the training set we’re sending 3 variables:</p>\n<ul>\n<li>training dataset (as pandas Dataframe)</li>\n<li>list of columns to normalize</li>\n<li>list of columns to scale</li>\n</ul>\n<p>When we’re processing training data we have to define dataset for scaling/normalization process. This dataset is used to get values like <strong>mean</strong> or <strong>standard diviation</strong>. Because at the point of processing training dataset we don’t have any external datasets, we’re using training dataset. At line 19 we’re normalizing selected columns using <code>StandardScaler()</code>:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"python\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"17\"></span><span class=\"grvsc-source\"><span class=\"mtk10\">if</span><span class=\"mtk1\"> norm_cols</span><span class=\"mtk6\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"18\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3 mtki\"># Normalize temp and percipation</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"19\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">norm_cols</span><span class=\"mtk6\">]</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> StandardScaler</span><span class=\"mtk6\">().</span><span class=\"mtk1\">fit</span><span class=\"mtk6\">(</span><span class=\"mtk1\">train_scale</span><span class=\"mtk6\">[</span><span class=\"mtk1\">norm_cols</span><span class=\"mtk6\">]).</span><span class=\"mtk1\">transform</span><span class=\"mtk6\">(</span><span class=\"mtk1\">new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">norm_cols</span><span class=\"mtk6\">])</span></span></span></code></pre>\n<p>StandardScaler doesn’t require any parameters when initializing, but it require scale dataset to fit to. We could just past the <code>new_data</code> twice and it would work but then we need to create another preprocessing for test dataset.</p>\n<p>Next we’re doing the same thing but with <code>MinMaxScaler()</code>.</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"python\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"21\"></span><span class=\"grvsc-source\"><span class=\"mtk10\">if</span><span class=\"mtk1\"> scale_cols</span><span class=\"mtk6\">:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"22\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3 mtki\"># Scale year and week no but within (0,1)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"23\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">    new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">scale_cols</span><span class=\"mtk6\">]</span><span class=\"mtk1\"> </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> MinMaxScaler</span><span class=\"mtk6\">(</span><span class=\"mtk7\">feature_range</span><span class=\"mtk6\">=(</span><span class=\"mtk5\">0</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> </span><span class=\"mtk5\">1</span><span class=\"mtk6\">)).</span><span class=\"mtk1\">fit</span><span class=\"mtk6\">(</span><span class=\"mtk1\">train_scale</span><span class=\"mtk6\">[</span><span class=\"mtk1\">scale_cols</span><span class=\"mtk6\">]).</span><span class=\"mtk1\">transform</span><span class=\"mtk6\">(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"24\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">        new_data</span><span class=\"mtk6\">[</span><span class=\"mtk1\">scale_cols</span><span class=\"mtk6\">])</span></span></span></code></pre>\n<p>This time we’re passing one parameter called <code>feature_range</code> to be sure that our scale is in range &#x3C;0,1>. As in the previous example we’re passing scaling dataset to fit to and transform selected columns.</p>\n<p>At the end, we’re returning transformed <code>new_data</code> and additionally <code>train_scale</code> for further preprocessing. But wait the second! What further preprocessing? Remember that we’re dealing not only with training dataset but also with test dataset. We have to apply the same data processing for both of them to have the same input for the model. If we would simply use <code>preproc_data()</code> in the same way for the test dataset we would apply completely different normalization and scaling. Reason why is because normalization and scaling is done by <code>.fit()</code> method and this method uses some given dataset to calculate <strong>mean</strong> and other required values. If you use test dataset which might have a different range of values (there was a hot summer because of global warming etc.) your value of 28C in test dataset will be normalized with a different parameters. Let me show you an example:</p>\n<p>Training Dataset:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">[</mo><mn>22</mn><mo separator=\"true\">,</mo><mn>23</mn><mo separator=\"true\">,</mo><mn>23</mn><mo separator=\"true\">,</mo><mn>24</mn><mo separator=\"true\">,</mo><mn>25</mn><mo separator=\"true\">,</mo><mn>26</mn><mo separator=\"true\">,</mo><mn>24</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[22,23,23,24,25,26,24]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mclose\">]</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>μ</mi><mo>=</mo><mn>23.86</mn></mrow><annotation encoding=\"application/x-tex\">\\mu = 23.86</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">μ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">3</span><span class=\"mord\">.</span><span class=\"mord\">8</span><span class=\"mord\">6</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1.25</mn></mrow><annotation encoding=\"application/x-tex\">\\sigma = 1.25</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">2</span><span class=\"mord\">5</span></span></span></span></span>\n<p>Testing Dataset:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">[</mo><mn>24</mn><mo separator=\"true\">,</mo><mn>24</mn><mo separator=\"true\">,</mo><mn>25</mn><mo separator=\"true\">,</mo><mn>26</mn><mo separator=\"true\">,</mo><mn>25</mn><mo separator=\"true\">,</mo><mn>24</mn><mo separator=\"true\">,</mo><mn>26</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[24,24,25,26,25,24,26]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">2</span><span class=\"mord\">6</span><span class=\"mclose\">]</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>μ</mi><mo>=</mo><mn>24.86</mn></mrow><annotation encoding=\"application/x-tex\">\\mu = 24.86</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.19444em;\"></span><span class=\"mord mathdefault\">μ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">2</span><span class=\"mord\">4</span><span class=\"mord\">.</span><span class=\"mord\">8</span><span class=\"mord\">6</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mi>σ</mi><mo>=</mo><mn>0.83</mn></mrow><annotation encoding=\"application/x-tex\">\\sigma = 0.83</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.43056em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">8</span><span class=\"mord\">3</span></span></span></span></span>\n<p>Normalizing Testing Dataset using mean and SD from Training Dataset gives us:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0.11</mn><mo separator=\"true\">,</mo><mn>0.11</mn><mo separator=\"true\">,</mo><mn>0.91</mn><mo separator=\"true\">,</mo><mn>1.71</mn><mo separator=\"true\">,</mo><mn>0.91</mn><mo separator=\"true\">,</mo><mn>0.11</mn><mo separator=\"true\">,</mo><mn>1.71</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[0.11, 0.11, 0.91, 1.71, 0.91, 0.11, 1.71]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">9</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">9</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">7</span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span></span>\n<p>But if you use mean and SD from Testing dataset you’ll end up with:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1.04</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1.04</mn><mo separator=\"true\">,</mo><mn>0.17</mn><mo separator=\"true\">,</mo><mn>1.37</mn><mo separator=\"true\">,</mo><mn>0.17</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1.04</mn><mo separator=\"true\">,</mo><mn>1.37</mn><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[-1.04, -1.04, 0.17, 1.37, 0.17, -1.04, 1.37]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">0</span><span class=\"mord\">.</span><span class=\"mord\">1</span><span class=\"mord\">7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">0</span><span class=\"mord\">4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">1</span><span class=\"mord\">.</span><span class=\"mord\">3</span><span class=\"mord\">7</span><span class=\"mclose\">]</span></span></span></span></span>\n<p>You might think that second one is better describing the datset but that’s only true when dealing with <strong>only</strong> the testing dataset. </p>\n<p>That’s why when building our model we have to execute it like that:</p>\n<pre class=\"grvsc-container quiet-light\" data-language=\"python\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">unnormalized_train_data </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> extract_data</span><span class=\"mtk6\">(</span><span class=\"mtk1\">path_to_train_file</span><span class=\"mtk6\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">normalized_train_data</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> train_scale </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> preproc_data</span><span class=\"mtk6\">(</span><span class=\"mtk1\">unnormalized_train_data</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> norm_cols</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> scale_cols</span><span class=\"mtk6\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">//</span><span class=\"mtk1\"> Create </span><span class=\"mtk6\">and</span><span class=\"mtk1\"> train model</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">unnormalized_test_data </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> extract_data</span><span class=\"mtk6\">(</span><span class=\"mtk1\">path_to_test_file</span><span class=\"mtk6\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">normalized_test_data</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> _ </span><span class=\"mtk6\">=</span><span class=\"mtk1\"> preproc_data</span><span class=\"mtk6\">(</span><span class=\"mtk1\">unnormalized_test_data</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> norm_cols</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> scale_cols</span><span class=\"mtk6\">,</span><span class=\"mtk1\"> train_scale</span><span class=\"mtk6\">)</span></span></span></code></pre>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>We’ve just gone through quite standard normalization proces for our dataset. It is important to understand the difference between normalization and scalling. Another thing which might be even more important is feature selection for normalization (example with different temperature features), you should alwyas try to understand your features, not only apply some hardcoded rules from the internet.</p>\n<p>Last thing that i have to mention (and you’ve probalby already though about it) is difference between data range in training and testing dataset. You know that normalization of the testing data should be done with the variables from training data, but whouldn’t we adjust the process to fit into different range? Lets say training dataset has temperature range between 15C and 23C and testing dataset has range between 18C and 28C. Isn’t that a problem for our model? Actually it isn’t :) Models doesn’t really care about small changes like that because they are aproximating continous functions (or distributions) and unless your range differes a lot (it’s from different distribution) you shouldn’t have any issues with it.</p>\n<h2 id=\"references\"><a href=\"#references\" aria-label=\"references permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>References:</h2>\n<ul>\n<li>DengAI: Predicting Disease Spread <a href=\"https://www.drivendata.org/competitions/44/dengai-predicting-disease-spread/\">https://www.drivendata.org/competitions/44/dengai-predicting-disease-spread/</a></li>\n</ul>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .quiet-light { background-color: #F5F5F5; }\n  .quiet-light .mtki { font-style: italic; }\n  .quiet-light .mtkb { font-weight: bold; }\n  .quiet-light .mtk6 { color: #777777; }\n  .quiet-light .mtk4 { color: #448C27; }\n  .quiet-light .mtk10 { color: #4B69C6; }\n  .quiet-light .mtk1 { color: #333333; }\n  .quiet-light .mtk7 { color: #7A3E9D; }\n  .quiet-light .mtk9 { color: #AA3731; }\n  .quiet-light .mtk5 { color: #9C5D27; }\n  .quiet-light .mtk3 { color: #AAAAAA; }\n  .quiet-light .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(0, 0, 0, 0.05));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(0, 0, 0, 0.2));\n  }\n</style>"}},"pageContext":{"slug":"/2020/08/deng-ai-data-preprocessing"}}}